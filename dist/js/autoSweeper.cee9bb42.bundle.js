(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{6:function(e,t,o){"use strict";o.r(t),o.d(t,"autoSweeper",(function(){return a}));var n=o(0),i=o(1);function r(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return l(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var a={col:0,blocks:0,blockIDs:"",mineNumber:0,mineRate:0,showAiFootprint:!0,blocksBoard:[],unFullDoneBlocks:[],enableClick:[],rightEnableSet:new Set,leftEnableSet:new Set,clickCount:0,markedCount:0,unCoverCount:0,debugMode:!1,aiDelay:0,getBoardInfo:function(e){var t=this;this.blocks=e.blocks,this.mineRate=e.mineRate,this.mineNumber=e.mineNumber,this.blockIDs=e.blockIDs,this.col=e.col,this.debugMode=e.debugMode,this.aiDelay=e.aiDelay,this.debugMode&&console.log("autoSweeper init, info:",e),this._initAiBoard(),setTimeout((function(){t._sendClick(t._chooseFirstClick(),"left")}),this.aiDelay)},_initAiBoard:function(){this.blocksBoard=[];for(var e=0;e<this.blocks;e++)this.blocksBoard.push({value:0,status:"cover",mineRate:0,fullDone:!1,computed:!1})},_sendClick:function(e,t){var o=n.a.clickForAi(e,t)||[];return"left"===t?(this.clickCount++,this.unCoverCount+=o.length):this.markedCount++,this.debugMode&&this._highlightAiClick(e,t),"BOOM"===o[0]?(console.log("Ai failed!!! BOOM index:",o[1]),void(this.debugMode&&console.log("this.blocksBoard:",this.blocksBoard))):"Succ"===o[0]?(console.log("Ai Won!!!"),void(this.debugMode&&console.log("Ai Win!!!"))):(this._handleFullDone(e,t),this._handleClickResult(o),this._computeClickItem(),void this._clickEnableBlock())},_clickEnableBlock:function(){var e=this;if(this.rightEnableSet.size>0){var t=r(this.rightEnableSet)[0];this.rightEnableSet.delete(t),setTimeout((function(){e._sendClick(t,"right")}),this.aiDelay)}else if(this.leftEnableSet.size>0){var o=r(this.leftEnableSet)[0];this.leftEnableSet.delete(o),setTimeout((function(){e._sendClick(o,"left")}),this.aiDelay)}else{var n=this._getMinRateBlock();this.debugMode&&console.log("minRateBlockIndex:",n),-1!==n?setTimeout((function(){e._sendClick(n,"left")}),this.aiDelay):console.log("minRateBlockIndex = -1")}},_handleClickResult:function(e){var t=this;e.forEach((function(e){t.blocksBoard[e.index].status="uncover",t.blocksBoard[e.index].mineRate=0,t.blocksBoard[e.index].value=e.value,t.blocksBoard[e.index].computed=!0,t.blocksBoard[e.index].fullDone=0===e.value,t.rightEnableSet.has(e.index)&&t.rightEnableSet.delete(e.index),t.leftEnableSet.has(e.index)&&t.leftEnableSet.delete(e.index)}))},_computeClickItem:function(){var e=this;this.blocksBoard.forEach((function(t,o){if("uncover"===t.status&&!t.fullDone){var n=e._getAroundStatusNum(o);0===n.markedCount?n.coverCount===t.value?(n.coverIndex.forEach((function(t){e.rightEnableSet.add(t)})),e._handleFullDone(o,"done")):n.coverCount>t.value&&n.coverIndex.forEach((function(o){var i=Number((t.value/n.coverCount).toFixed(3));i>e.blocksBoard[o].mineRate&&(e.blocksBoard[o].mineRate=i,e.blocksBoard[o].computed=!0)})):n.markedCount===t.value?(n.coverIndex.forEach((function(t){e.leftEnableSet.add(t)})),e._handleFullDone(o,"done")):n.markedCount+n.coverCount===t.value?(n.coverIndex.forEach((function(t){e.rightEnableSet.add(t)})),e._handleFullDone(o,"done")):n.coverIndex.forEach((function(o){var i=Number(((t.value-n.markedCount)/n.coverCount).toFixed(3));i>e.blocksBoard[o].mineRate&&(e.blocksBoard[o].mineRate=i,e.blocksBoard[o].computed=!0)}))}}))},_getMinRateBlock:function(){for(var e,t,o=Number(((this.mineNumber-this.markedCount)/(this.blocks-this.markedCount-this.unCoverCount)).toFixed(3)),n=0;n<this.blocksBoard.length;n++)"cover"===this.blocksBoard[n].status&&(this.blocksBoard[n].computed||(this.blocksBoard[n].mineRate=o));return this.blocksBoard.forEach((function(o,n){if("cover"===o.status)return t=o.mineRate,void(e=n)})),void 0!==e?(this.blocksBoard.forEach((function(o,n){"cover"===o.status&&o.mineRate<t&&(t=o.mineRate,e=n)})),e):-1},_handleFullDone:function(e,t){"right"===t?(this.blocksBoard[e].status="marked",this.blocksBoard[e].mineRate=1,this.blocksBoard[e].value="X",this.blocksBoard[e].fullDone=!0,this.blocksBoard[e].computed=!0):"done"===t&&(this.blocksBoard[e].fullDone=!0,this.blocksBoard[e].computed=!0)},_getAroundStatusNum:function(e){var t=this,o={coverCount:0,coverIndex:[],markedCount:0,markedIndex:[]},n=Object(i.a)(e,this.blocks,this.col);return n.forEach((function(e){"cover"===t.blocksBoard[e].status?(o.coverCount++,o.coverIndex.push(e)):"marked"===t.blocksBoard[e].status&&(o.markedCount++,o.markedIndex.push(e))})),o.coverCount===n.length&&(o.coverCount=-1),o},_checkFullDone:function(e){var t=this;return Object(i.a)(e,this.blocks,this.col).forEach((function(e){if("cover"===t.blocksBoard[e].status)return!1})),!0},_chooseFirstClick:function(){return console.log("Good Luck with Ai ^_^"),Math.floor(Math.random()*(this.blocks-1))},_highlightAiClick:function(e,t){if(this.showAiFootprint){var o=document.getElementById(this.blockIDs+e);"left"===t?o.classList.add("ai-left-click"):"right"===t&&o.classList.add("ai-right-click")}}}}}]);